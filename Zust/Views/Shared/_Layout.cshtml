@using Microsoft.AspNetCore.Identity;
@using Zust.Entities.Models;
@{
    var userManager = Context.RequestServices.GetService<UserManager<User>>();
    var user = await userManager.GetUserAsync(Context.User);
}

<!doctype html>
<html lang="zxx">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Links of CSS files -->
    <link rel="stylesheet" href="~/assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="~/assets/css/animate.min.css">
    <link rel="stylesheet" href="~/assets/css/remixicon.css">
    <link rel="stylesheet" href="~/assets/css/flaticon.css">
    <link rel="stylesheet" href="~/assets/css/jquery-ui.min.css">
    <link rel="stylesheet" href="~/assets/css/magnific-popup.min.css">
    <link rel="stylesheet" href="~/assets/css/simplebar.min.css">
    <link rel="stylesheet" href="~/assets/css/metismenu.min.css">
    <link rel="stylesheet" href="~/assets/css/owl.carousel.min.css">
    <link rel="stylesheet" href="~/assets/css/owl.theme.default.min.css">
    <link rel="stylesheet" href="~/assets/css/style.css">
    <link rel="stylesheet" href="~/assets/css/responsive.css">

    <title>@ViewData["Title"]</title>

    <link rel="icon" type="image/png" href="~/assets/images/favicon.png">
</head>

<style>
    #hide{
        visibility: hidden;
    }

    .myimg{
        max-width: 40px !important;
        min-width: 40px !important;
        width: 40px !important;
        max-height: 40px !important;
        min-height: 40px !important;
        height: 40px !important;
    }

    #chats{
        max-height: 220px;
        overflow-y: scroll;
    }

    .chat-body::-webkit-scrollbar {
        width: 8px; /* Width of the scrollbar */
    }

    .chat-body::-webkit-scrollbar-thumb {
        background-color: #888; /* Color of the scrollbar thumb (the draggable part) */
        border-radius: 4px; /* Border radius of the scrollbar thumb */
    }

        .chat-body::-webkit-scrollbar-thumb:hover {
            background-color: #555; /* Color of the scrollbar thumb when hovered */
        }

    /* Hide scrollbar for Firefox */
    .chat-body {
        scrollbar-width: thin;
        scrollbar-color: #888 #f5f5f5;
    }

        .chat-body::-webkit-scrollbar-track {
            background: #f5f5f5; /* Color of the scrollbar track */
        }
</style>

<body>

    <div class="preloader-area">
        <div class="spinner">
            <div class="inner">
                <div class="disc"></div>
                <div class="disc"></div>
                <div class="disc"></div>
            </div>
        </div>
    </div>
    <!-- End Preloader Area -->
    <!-- Start Main Content Wrapper Area -->
    <div class="main-content-wrapper d-flex flex-column">

        <!-- Start Navbar Area -->
        <div class="navbar-area">
          @*  <div class="main-responsive-nav">
                <div class="main-responsive-menu">
                    <div class="responsive-burger d-none" style="width: 25px;" id="hide">
                        <span class="top-bar"></span>
                        <span class="middle-bar"></span>
                        <span class="bottom-bar"></span>
                    </div>
                </div>
            </div>*@

            <div class="main-navbar">
                <nav class="navbar navbar-expand-lg navbar-light">
                    <a href="/home/index" class="navbar-brand d-flex align-items-center">
                        <img src="~/assets/images/logo.png" alt="image">
                    </a>

                    <div class="collapse navbar-collapse" id="navbarSupportedContent">
                        <div class="navbar-burger-menu m-auto" id="hide">
                            <span class="top-bar"></span>
                            <span class="middle-bar"></span>
                            <span class="bottom-bar"></span>
                        </div>

                        <div class="others-options d-flex align-items-center">

                            <div class="option-item">
                                <a href="/home/index" class="home-btn"><i class="flaticon-home"></i></a>
                            </div>

                            <div class="option-item">
                                <div class="dropdown friend-requests-nav-item">
                                    <a href="/home/friend-requests">
                                        <div class="friend-requests-btn">
                                            <i class="flaticon-user"></i>
                                            @*Number Of Friend Requests*@
                                            <span id="numberOfFriendRequests">0</span>
                                        </div>
                                    </a>
                                </div>
                            </div>
                            <div class="option-item">
                                <div class="dropdown messages-nav-item">
                                    <a href="/home/messages">
                                        <div class="messages-btn">
                                            <i class="flaticon-email"></i>
                                            @*Number of Messages*@
                                            <span>0</span>
                                        </div>
                                    </a>
                                </div>
                            </div>
                            <div class="option-item">
                                <div class="dropdown notifications-nav-item">
                                    <a href="/home/notifications">
                                        <div class="notifications-btn">
                                            <i class="flaticon-bell"></i>
                                            @*Number of Notifications*@
                                            <span id="numberOfNotifications">0</span>
                                        </div>
                                    </a>
                                </div>
                            </div>

                            <div class="option-item">
                                @*Languages*@
                                <div class="dropdown language-option">
                                    <button class="dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        <i class="flaticon-global"></i>
                                        <span class="lang-name"></span>
                                    </button>
                                    <div class="dropdown-menu language-dropdown-menu">
                                        <a class="dropdown-item" href="#">
                                            <img src="~/assets/images/uk.png" alt="flag">
                                            Eng
                                        </a>
                                        <a class="dropdown-item" href="#">
                                            <img src="~/assets/images/china.png" alt="flag">
                                            简体中文
                                        </a>
                                        <a class="dropdown-item" href="#">
                                            <img src="~/assets/images/uae.png" alt="flag">
                                            العربيّة
                                        </a>
                                    </div>
                                </div>
                            </div>
                            <div class="option-item">
                                <div class="dropdown profile-nav-item">
                                    <a href="#" class="dropdown-bs-toggle" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        <div class="menu-profile">
                                            @*User Image*@
                                            <img src="@user.ImageUrl" class="rounded-circle" alt="image">
                                            @*Username*@
                                            <span class="name">@user.UserName</span>
                                            <span class="status-online"></span>
                                        </div>
                                    </a>

                                    <div class="dropdown-menu">
                                        <div class="profile-header">
                                            <h3>@user.UserName</h3>
                                            <a href="mailto:@user.Email">@user.Email</a>
                                        </div>
                                        <ul class="profile-body">
                                            <li><i class="flaticon-user"></i> <a href="/home/my-profile">My Profile</a></li>
                                            <li><i class="flaticon-settings"></i> <a href="/account/settings">Setting</a></li>
                                            <li><i class="flaticon-privacy"></i> <a href="/home/privacy">Privacy</a></li>
                                            <li><i class="flaticon-information"></i> <a href="/home/help-and-support">Help & Support</a></li>
                                            <li><i class="flaticon-logout"></i> <a href="/account/login">Logout</a></li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </nav>
            </div>

            @*For responsiveness*@
            <div class="others-option-for-responsive">
                <div class="container">
                    <div class="dot-menu">
                        <div class="inner">
                            <div class="circle circle-one"></div>
                            <div class="circle circle-two"></div>
                            <div class="circle circle-three"></div>
                        </div>
                    </div>

                    <div class="container">
                        <div class="option-inner">
                            <div class="others-options d-flex align-items-center">
                                <div class="option-item">
                                    <a href="/home/index" class="home-btn"><i class="flaticon-home"></i></a>
                                </div>
                                <div class="option-item">
                                    <div class="dropdown friend-requests-nav-item">
                                        <a href="#" class="dropdown-bs-toggle" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                            <div class="friend-requests-btn">
                                                <i class="flaticon-user"></i>
                                                <span>0</span>
                                            </div>
                                        </a>

                                        <div class="dropdown-menu">
                                            <div class="friend-requests-header d-flex justify-content-between align-items-center">
                                                <h3>Friend Requests</h3>
                                                <i class="flaticon-menu"></i>
                                            </div>

                                            <div class="friend-requests-body">
                                                <div class="item d-flex align-items-center">
                                                    <div class="figure">
                                                        <a href="#"><img src="~/assets/images/user/user-2.jpg" class="rounded-circle" alt="image"></a>
                                                    </div>

                                                    <div class="content d-flex justify-content-between align-items-center">
                                                        <div class="text">
                                                            <h4><a href="#">Sandra Cross</a></h4>
                                                            <span>26 Friends</span>
                                                        </div>
                                                        <div class="btn-box d-flex align-items-center">
                                                            <button class="delete-btn d-inline-block me-2" data-bs-toggle="tooltip" data-bs-placement="top" title="Delete" type="button"><i class="ri-close-line"></i></button>

                                                            <button class="confirm-btn d-inline-block" data-bs-toggle="tooltip" data-bs-placement="top" title="Confirm" type="button"><i class="ri-check-line"></i></button>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="item d-flex align-items-center">
                                                    <div class="figure">
                                                        <a href="#"><img src="~/assets/images/user/user-3.jpg" class="rounded-circle" alt="image"></a>
                                                    </div>

                                                    <div class="content d-flex justify-content-between align-items-center">
                                                        <div class="text">
                                                            <h4><a href="#">Kenneth Crowe</a></h4>
                                                            <span>53 Friends</span>
                                                        </div>
                                                        <div class="btn-box d-flex align-items-center">
                                                            <button class="delete-btn d-inline-block me-2" data-bs-toggle="tooltip" data-bs-placement="top" title="Delete" type="button"><i class="ri-close-line"></i></button>

                                                            <button class="confirm-btn d-inline-block" data-bs-toggle="tooltip" data-bs-placement="top" title="Confirm" type="button"><i class="ri-check-line"></i></button>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="item d-flex align-items-center">
                                                    <div class="figure">
                                                        <a href="#"><img src="~/assets/images/user/user-4.jpg" class="rounded-circle" alt="image"></a>
                                                    </div>

                                                    <div class="content d-flex justify-content-between align-items-center">
                                                        <div class="text">
                                                            <h4><a href="#">Andrea Harwell</a></h4>
                                                            <span>99 Friends</span>
                                                        </div>
                                                        <div class="btn-box d-flex align-items-center">
                                                            <button class="delete-btn d-inline-block me-2" data-bs-toggle="tooltip" data-bs-placement="top" title="Delete" type="button"><i class="ri-close-line"></i></button>

                                                            <button class="confirm-btn d-inline-block" data-bs-toggle="tooltip" data-bs-placement="top" title="Confirm" type="button"><i class="ri-check-line"></i></button>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="item d-flex align-items-center">
                                                    <div class="figure">
                                                        <a href="#"><img src="~/assets/images/user/user-5.jpg" class="rounded-circle" alt="image"></a>
                                                    </div>

                                                    <div class="content d-flex justify-content-between align-items-center">
                                                        <div class="text">
                                                            <h4><a href="#">John Lago</a></h4>
                                                            <span>18 Friends</span>
                                                        </div>
                                                        <div class="btn-box d-flex align-items-center">
                                                            <button class="delete-btn d-inline-block me-2" data-bs-toggle="tooltip" data-bs-placement="top" title="Delete" type="button"><i class="ri-close-line"></i></button>

                                                            <button class="confirm-btn d-inline-block" data-bs-toggle="tooltip" data-bs-placement="top" title="Confirm" type="button"><i class="ri-check-line"></i></button>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="view-all-requests-btn">
                                                    <a href="/home/friends" class="default-btn">View All Requests</a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="option-item">
                                    <div class="dropdown messages-nav-item">
                                        <a href="#" class="dropdown-bs-toggle" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                            <div class="messages-btn">
                                                <i class="flaticon-email"></i>
                                                <span>2</span>
                                            </div>
                                        </a>

                                        <div class="dropdown-menu">
                                            <div class="messages-header d-flex justify-content-between align-items-center">
                                                <h3>Messages</h3>
                                                <i class="flaticon-menu"></i>
                                            </div>
                                            <div class="messages-body">
                                                <div class="item d-flex justify-content-between align-items-center">
                                                    <div class="figure">
                                                        <a href="#"><img src="~/assets/images/user/user-11.jpg" class="rounded-circle" alt="image"></a>
                                                    </div>
                                                    <div class="text">
                                                        <h4><a href="#">James Vanwin</a></h4>
                                                        <span>Hello Dear I Want Talk To You</span>
                                                    </div>
                                                </div>
                                                <div class="item d-flex justify-content-between align-items-center">
                                                    <div class="figure">
                                                        <a href="#"><img src="~/assets/images/user/user-12.jpg" class="rounded-circle" alt="image"></a>
                                                    </div>
                                                    <div class="text">
                                                        <h4><a href="#">Harry Lopez</a></h4>
                                                        <span>Hi. I Am looking For UI Designer</span>
                                                    </div>
                                                </div>
                                                <div class="item d-flex justify-content-between align-items-center">
                                                    <div class="figure">
                                                        <a href="#"><img src="~/assets/images/user/user-13.jpg" class="rounded-circle" alt="image"></a>
                                                    </div>
                                                    <div class="text">
                                                        <h4><a href="#">Matthew Smith</a></h4>
                                                        <span>Thanks For Connecting!</span>
                                                    </div>
                                                </div>
                                                <div class="item d-flex justify-content-between align-items-center">
                                                    <div class="figure">
                                                        <a href="#"><img src="~/assets/images/user/user-14.jpg" class="rounded-circle" alt="image"></a>
                                                    </div>
                                                    <div class="text">
                                                        <h4><a href="#">Russe Smith</a></h4>
                                                        <span>Thanks For Connecting!</span>
                                                    </div>
                                                </div>
                                                <div class="view-all-messages-btn">
                                                    <a href="/home/messages" class="default-btn">View All Messages</a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="option-item">
                                    <div class="dropdown notifications-nav-item">
                                        <a class="dropdown-bs-toggle" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                            <div class="notifications-btn">
                                                <i class="flaticon-bell"></i>
                                                <span></span>
                                            </div>
                                        </a>

                                        <div class="dropdown-menu">
                                            <div class="notifications-header d-flex justify-content-between align-items-center">
                                                <h3>Notifications</h3>
                                                <i class="flaticon-menu"></i>
                                            </div>
                                            <div class="notifications-body">
                                                <div class="item d-flex justify-content-between align-items-center">
                                                    <div class="figure">
                                                        <a href="#"><img src="~/assets/images/user/user-11.jpg" class="rounded-circle" alt="image"></a>
                                                    </div>
                                                    <div class="text">
                                                        <h4><a href="#">James Vanwin</a></h4>
                                                        <span>Posted A Comment On Your Status</span>
                                                        <span class="main-color">20 Minites Ago</span>
                                                    </div>
                                                </div>
                                                <div class="item d-flex justify-content-between align-items-center">
                                                    <div class="figure">
                                                        <a href="#"><img src="~/assets/images/user/user-12.jpg" class="rounded-circle" alt="image"></a>
                                                    </div>
                                                    <div class="text">
                                                        <h4><a href="#">Harry Lopez</a></h4>
                                                        <span>Sent You A Friend Request</span>
                                                        <span class="main-color">2 Days Ago</span>
                                                    </div>
                                                </div>
                                                <div class="item d-flex justify-content-between align-items-center">
                                                    <div class="figure">
                                                        <a href="#"><img src="~/assets/images/user/user-13.jpg" class="rounded-circle" alt="image"></a>
                                                    </div>
                                                    <div class="text">
                                                        <h4><a href="#">Matthew Smith</a></h4>
                                                        <span>Add A Photo In Design Group</span>
                                                        <span class="main-color">3 Days Ago</span>
                                                    </div>
                                                </div>
                                                <div class="view-all-notifications-btn">
                                                    <a href="/home/notifications" class="default-btn">View All Notifications</a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="option-item">
                                    <div class="dropdown language-option">
                                        <button class="dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                            <i class="flaticon-global"></i>
                                            <span class="lang-name"></span>
                                        </button>
                                        <div class="dropdown-menu language-dropdown-menu">
                                            <a class="dropdown-item" href="#">
                                                <img src="~/assets/images/uk.png" alt="flag">
                                                Eng
                                            </a>
                                            <a class="dropdown-item" href="#">
                                                <img src="~/assets/images/china.png" alt="flag">
                                                简体中文
                                            </a>
                                            <a class="dropdown-item" href="#">
                                                <img src="~/assets/images/uae.png" alt="flag">
                                                العربيّة
                                            </a>
                                        </div>
                                    </div>
                                </div>
                                <div class="option-item">
                                    <div class="dropdown profile-nav-item">
                                        <a href="#" class="dropdown-bs-toggle" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                            <div class="menu-profile">
                                                <img src="~/assets/images/user/user-1.jpg" class="rounded-circle" alt="image">
                                                <span class="name">Matthew</span>
                                                <span class="status-online"></span>
                                            </div>
                                        </a>

                                        <div class="dropdown-menu">
                                            <div class="profile-header">
                                                <h3>@user</h3>
                                                <a href="mailto:matthew507@gmail.com">matthew507@gmail.com</a>
                                            </div>
                                            <ul class="profile-body">
                                                <li><i class="flaticon-user"></i> <a href="/home/my-profile">My Profile</a></li>
                                                <li><i class="flaticon-settings"></i> <a href="/account/settings">Setting</a></li>
                                                <li><i class="flaticon-privacy"></i> <a href="/home/privacy">Privacy</a></li>
                                                <li><i class="flaticon-information"></i> <a href="/home/help-and-support">Help & Support</a></li>
                                                <li><i class="flaticon-logout"></i> <a href="/account/login">Logout</a></li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                                <div class="option-item">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- End Navbar Area -->
        <!-- Start Sidemenu Area -->
        <div class="sidemenu-area">
            <div class="responsive-burger-menu d-lg-none d-block">
                <span class="top-bar"></span>
                <span class="middle-bar"></span>
                <span class="bottom-bar"></span>
            </div>

            <div class="sidemenu-body">
                <ul class="sidemenu-nav metisMenu h-100" id="sidemenu-nav" data-simplebar>
                    <li id="1" class="nav-item active">
                        <a href="/home/index" class="nav-link">
                            <span class="icon"><i class="flaticon-newspaper"></i></span>
                            <span class="menu-title">News Feed</span>
                        </a>
                    </li>
                    <li id="3" class="nav-item">
                        <a href="/home/friends" class="nav-link">
                            <span class="icon"><i class="flaticon-friends"></i></span>
                            <span class="menu-title">Friends</span>
                        </a>
                    </li>
                    <li id="4" class="nav-item">
                        <a href="/home/notifications" class="nav-link">
                            <span class="icon"><i class="flaticon-bell"></i></span>
                            <span class="menu-title">Notifications</span>
                        </a>
                    </li>
                    <li id="5" class="nav-item">
                        <a href="/home/friend-requests" class="nav-link">
                            <span class="icon"><i class="flaticon-add"></i></span>
                            <span class="menu-title">Requests</span>
                        </a>
                    </li>
                    <li id="6" class="nav-item">
                        <a href="/home/chats" class="nav-link">
                            <span class="icon"><i class="flaticon-comment-1"></i></span>
                            <span class="menu-title">Chats</span>
                        </a>
                    </li>

                    @* <li id="5" class="nav-item">
                    <a href="/home/groups" class="nav-link">
                    <span class="icon"><i class="flaticon-team"></i></span>
                    <span class="menu-title">Groups</span>
                    </a>
                    </li>*@
                    @*  <li id="6" class="nav-item">
                    <a href="/home/favorite" class="nav-link">
                    <span class="icon"><i class="flaticon-star"></i></span>
                    <span class="menu-title">Favorite</span>
                    </a>
                    </li>*@
                    @*<li id="7" class="nav-item">
                    <a href="/home/events" class="nav-link">
                    <span class="icon"><i class="flaticon-calendar"></i></span>
                    <span class="menu-title">Events</span>
                    </a>
                    </li>*@
                    @*  <li id="8" class="nav-item">
                    <a href="/home/live-chat" class="nav-link">
                    <span class="icon"><i class="flaticon-live-chat"></i></span>
                    <span class="menu-title">Live Chat</span>
                    </a>
                    </li>*@
                    @*  <li id="9" class="nav-item">
                    <a href="/home/birthday" class="nav-link">
                    <span class="icon"><i class="flaticon-cake"></i></span>
                    <span class="menu-title">Birthday</span>
                    </a>
                    </li>*@
                    @*<li id="10" class="nav-item">
                    <a href="/home/video" class="nav-link">
                    <span class="icon"><i class="flaticon-video"></i></span>
                    <span class="menu-title">Video</span>
                    </a>
                    </li>*@
                    @*   <li id="12" class="nav-item">
                    <a href="/home/weather" class="nav-link">
                    <span class="icon"><i class="flaticon-cloudy"></i></span>
                    <span class="menu-title">Weather</span>
                    </a>
                    </li>*@
                    @*<li id="13" class="nav-item">
                    <a href="/home/marketplace" class="nav-link">
                    <span class="icon"><i class="flaticon-online-shopping"></i></span>
                    <span class="menu-title">Marketplace</span>
                    </a>
                    </li>*@
                    <li id="7" class="nav-item">
                        <a href="/home/my-profile" class="nav-link">
                            <span class="icon"><i class="flaticon-user"></i></span>
                            <span class="menu-title">My Profile</span>
                        </a>
                    </li>
                    <li id="8" class="nav-item">
                        <a href="/account/settings" class="nav-link">
                            <span class="icon"><i class="flaticon-settings"></i></span>
                            <span class="menu-title">Settings</span>
                        </a>
                    </li>
                    @*  <li id="14" class="nav-item">
                    <a href="/account/login" class="nav-link">
                    <span class="icon"><i class="flaticon-user"></i></span>
                    <span class="menu-title">Login</span>
                    </a>
                    </li>*@
                    @*  <li id="15" class="nav-item">
                    <a href="/account/register" class="nav-link">
                    <span class="icon"><i class="flaticon-information"></i></span>
                    <span class="menu-title">Register</span>
                    </a>
                    </li>*@
                </ul>
            </div>
        </div>
        <!-- End Sidemenu Area -->
        <!-- Start Content Page Box Area -->
        @RenderBody()
        <!-- End Content Page Box Area -->
        <!-- Start Right Sidebar Area -->
        <div class="right-sidebar-area" data-simplebar>
            <div class="recent-chat-box">
                <div class="title">
                    <h3>Chats</h3>
                </div>

              <div class="chat-body" data-simplebar id="chats">


                  </div>
            </div>

            <div class="recent-contact-box">
                <div class="title">
                    <h3>VIP Users</h3>
                </div>
                <div class="contact-body" data-simplebar id="special-users">
                </div>
            </div>
        </div>
        <!-- End Right Sidebar Area -->

    </div>
    <!-- End Main Content Wrapper Area -->
    <!-- Start Copyright Area -->
    <div class="copyrights-area">
        <div class="container">
            <div class="row align-items-center">
                <p><i class="ri-copyright-line"></i> 2023 Zust. All Rights Reserved</p>
            </div>
        </div>
    </div>
    <!-- End Copyright Area -->
    <!-- Start Go Top Area -->
    <div class="go-top">
        <i class="ri-arrow-up-line"></i>
    </div>
    <!-- End Go Top Area -->
    <!-- Links of JS files -->
    <script src="~/assets/js/functions.js"></script>
    <script src="~/assets/js/jquery.min.js"></script>
    <script src="~/assets/js/bootstrap.bundle.min.js"></script>
    <script src="~/assets/js/jquery.magnific-popup.min.js"></script>
    <script src="~/assets/js/jquery-ui.min.js"></script>
    <script src="~/assets/js/simplebar.min.js"></script>
    <script src="~/assets/js/metismenu.min.js"></script>
    <script src="~/assets/js/owl.carousel.min.js"></script>
    <script src="~/assets/js/wow.min.js"></script>
    <script src="~/assets/js/main.js"></script>
</body>
</html>

<script>
    var currentUserId = '@user.Id.ToString()';

    async function setData(){
        document.getElementById("numberOfFriendRequests").innerHTML = await makeAjaxRequest("/api/FriendRequest/GetPendingReceivedFriendRequestsCount?userId=" + currentUserId, "GET")
        document.getElementById("numberOfNotifications").innerHTML = await makeAjaxRequest("/api/Notification/GetUnreadNotificationCount?userId=" + currentUserId, "GET");
    }

    setData();

    var chats = document.getElementById("chats");

    var createChatHtml = function(user) {
        var content = `
            <div class="chat-item">
                <a href="/home/chats?userId=${user.id}"><img src="${user.imageUrl}" class="rounded-circle myimg" alt="image"></a>
                <span class="name"><a href="/home/chats?userId=${user.id}">${user.userName}</a></span>
            </div>
        `;
        return content;
    };

    async function getChats() {
        var users = await makeAjaxRequest(`/api/Chat/GetChats?userId=${currentUserId}`, "GET");
        if (users != null){
            users.forEach(user => {
                var html = createChatHtml(user);
                chats.innerHTML += html;
            });
        }
        else{
            chats.innerHTML = 'There is not chat';
        }
    }

    async function setChats() {
        await getChats();
    }

    setChats();

    function getSpecialUsers() {
        return new Promise(function (resolve, reject) {
            $.ajax({
                url: '/api/Static/GetSpecialUsers',
                type: 'GET',
                success: function (response) {
                    resolve(response);
                },
                error: function (error) {
                    reject(new Error(xhr.responseText));
                }
            });
        });
    }

    function createSpecialUserHtml(specialUser) {
        var redirectPage = '';
        if (specialUser.id == currentUserId){
            redirectPage = '/home/my-profile';
        }
        else{
            redirectPage = '/home/users?id=' + specialUser.id;
        }

        var content = `
          <div class="contact-item" style="display; flex !important; flex-wrap: nowrap !important;">
            <a href="${redirectPage}">
              <img src="${specialUser.imageUrl}" class="rounded-circle" alt="image" >
            </a>
            <span class="name">
                  <a href="${redirectPage}" style="display: inline-block;; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; margin-right: -15px; margin-top: 5px;">
                ${specialUser.userName}
              </a>
            </span>
          </div>`;
        return content;

    }

    async function setSpecialUsers() {
        var specialUsers = await getSpecialUsers();
        var container = document.getElementById("special-users");
        if (specialUsers != null && specialUsers.length > 0) {
            var htmlContainer = '';
            for (var i = 0; i < specialUsers.length; i++) {
                var specialUser = specialUsers[i]
                var html = createSpecialUserHtml(specialUser);
                htmlContainer += html;
            }
            container.innerHTML = htmlContainer;
        }
        else {
            container.style.color = 'red';
            container.innerHTML += "No special users";
        }
    }

    document.addEventListener("DOMContentLoaded", function () {
        setSpecialUsers();

        var navLinks = document.querySelectorAll('.nav-item');

        var activeItem = localStorage.getItem('activeMenuItem');

        // If an active menu item is found, add the "active" class to it
        if (activeItem) {
            navLinks.forEach(i => {
                i.classList.remove('active');
            })
            var id = parseInt(activeItem.replace("#", ""));
            document.getElementById(`${id}`).classList.add("active");
            localStorage.setItem('activeMenuItem', '#' + navLinks[0].id);
        }

        navLinks.forEach(function (link) {
            link.addEventListener('click', function (event) {
                navLinks.forEach(function (link) {
                    link.classList.remove('active');
                });

                this.classList.add('active');

                localStorage.setItem('activeMenuItem', '#' + this.id);
            });
        });
    });



</script>

